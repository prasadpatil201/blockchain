import pandas as pd                                   # Data handling
import numpy as np                                    # Numerical operations
from sklearn.model_selection import train_test_split  # Splitting data
from sklearn.neighbors import KNeighborsClassifier     # KNN Model
from sklearn.metrics import confusion_matrix, accuracy_score, precision_score, recall_score, f1_score  # Metrics

data = pd.read_csv('diabetes.csv')   # Load dataset

# Columns where zeros represent missing values
cols = ['Glucose','BloodPressure','SkinThickness','Insulin','BMI']

for c in cols:
    data[c] = data[c].replace(0, np.nan)        # Replace 0 with NaN
    data[c] = data[c].fillna(data[c].mean())    # Fill NaN with mean

X = data.iloc[:, :-1]         # All columns except last â†’ features
y = data['Outcome']           # Target column

x_train, x_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=1)         # Train-test split

knn = KNeighborsClassifier(n_neighbors=5)    # Create KNN model
knn.fit(x_train, y_train)                    # Train model

pred = knn.predict(x_test)                  # Predict test samples

cm = confusion_matrix(y_test, pred)         # Confusion matrix
acc = accuracy_score(y_test, pred)          # Accuracy
error = 1 - acc                             # Error rate
prec = precision_score(y_test, pred)        # Precision
rec = recall_score(y_test, pred)            # Recall
f1 = f1_score(y_test, pred)                 # F1 score

print("Confusion Matrix:\n", cm)
print("Accuracy:", acc)
print("Error Rate:", error)
print("Precision:", prec)
print("Recall:", rec)
print("F1 Score:", f1)

import pandas as pd                          # For data handling
from sklearn.model_selection import train_test_split   # To split dataset
from sklearn.neighbors import KNeighborsClassifier      # KNN model
from sklearn.svm import SVC                             # SVM model
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report  # Evaluation metrics

df = pd.read_csv("emails.csv")               # Load dataset

X = df.drop(columns=['Email No.', 'Prediction'])   # Features (removing unnecessary columns)
y = df['Prediction']                               # Target label (spam/ham)

xtr, xte, ytr, yte = train_test_split(X, y, test_size=0.2, random_state=0)  # Split dataset

knn = KNeighborsClassifier(n_neighbors=5)    # Create KNN model
knn.fit(xtr, ytr)                            # Train KNN
pred_knn = knn.predict(xte)                  # Predict using KNN

svm = SVC()                                  # Create SVM model
svm.fit(xtr, ytr)                            # Train SVM
pred_svm = svm.predict(xte)                  # Predict using SVM

print("=== KNN Results ===")                 
print("Accuracy:", accuracy_score(yte, pred_knn))                  # Accuracy of KNN
print("Confusion Matrix:\n", confusion_matrix(yte, pred_knn))      # Confusion matrix
print(classification_report(yte, pred_knn))                        # Precision, Recall, F1

print("=== SVM Results ===")
print("Accuracy:", accuracy_score(yte, pred_svm))                  # Accuracy of SVM
print("Confusion Matrix:\n", confusion_matrix(yte, pred_svm))      # Confusion matrix
print(classification_report(yte, pred_svm))                        # Precision, Recall, F1
